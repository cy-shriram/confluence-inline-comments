<a id="thelink" href="javascript: (function() {var a = document.querySelectorAll(&quot;.inline-comment-marker.valid, .comment-count-overlay&quot;);const output_xpath = '//*[@id=&quot;main&quot;]';const resolved_comments_view_btn_xpath = '//*[@id=&quot;view-resolved-comments&quot;]';const resolved_comments_close_btn_xpath = '//*[@id=&quot;resolved-dialog-close-button&quot;]';var i = 0;var output_div = document.createElement('div');var heading_span = document.createElement('span');var columns = [&quot;#&quot;, &quot;Section/Heading&quot;, &quot;Comment Text&quot;, &quot;Comment Username&quot;, &quot;Comment&quot;, &quot;Replies&quot;, &quot;Open/Resolved&quot;];var table_div_content = &quot;&quot;;heading_span.innerHTML = &quot;<h1>Inline Comments</h1>&quot;;output_div.appendChild(heading_span);var table_div = document.createElement('div');table_div.setAttribute('class', 'table-wrap');table_div_content = '<table class=&quot;relative-table wrapped confluenceTable ite-marked-table ite-real-table tablesorter tablesorter-default custom-ite-table stickyTableHeaders&quot; style=&quot;padding: 0px;&quot; role=&quot;grid&quot;><thead class=&quot;tableFloatingHeaderOriginal&quot;><tr ite-row-number=&quot;0&quot; role=&quot;row&quot; class=&quot;tablesorter-headerRow&quot;>';for (var j = 0; j < columns.length; j++) {table_div_content += '<th style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTh tablesorter-header sortableHeader tablesorter-headerUnSorted custom-row&quot; ite-col-number=&quot;[i]&quot; data-column=&quot;[i]&quot; tabindex=&quot;0&quot; scope=&quot;col&quot; role=&quot;columnheader&quot; aria-disabled=&quot;false&quot; unselectable=&quot;off&quot; aria-sort=&quot;none&quot;><div class=&quot;tablesorter-header-inner&quot;>'.replace(/\[i\]/g, &quot;[&quot; + j + &quot;]&quot;);table_div_content += columns[j] + '</div></th>';}table_div_content += '</tr></thead><tbody aria-live=&quot;polite&quot; aria-relevant=&quot;all&quot; class=&quot;ui-sortable&quot;>';if (a.length <= 0) {alert(&quot;No confluence comments found in this page...&quot;);return;}function process_resolved_comments(output_div, table_div, table_div_content) {document.evaluate(resolved_comments_view_btn_xpath, document).iterateNext().click();setTimeout(function() {const resolved_comments_div_xpath = '//*[@id=&quot;ic-resolved-comment-dialog&quot;]/div/div[2]';const resolved_comments_username_xpath = '//*[@id=&quot;ic-resolved-comment-dialog&quot;]/div/div[2]/div[i]/div[1]/div[1]/a[2]';const resolved_comments_text_xpath = '//*[@id=&quot;ic-resolved-comment-dialog&quot;]/div/div[2]/div[i]/div[1]/div[2]/div/blockquote';const resolved_comments_comment_xpath = '//*[@id=&quot;ic-resolved-comment-dialog&quot;]/div/div[2]/div[i]/div[1]/div[2]/div/p';const resolved_comments_link_xpath = '//*[@id=&quot;ic-resolved-comment-dialog&quot;]/div/div[2]/div[i]/div[1]/div[3]/ul';const resolved_comments_reply_div_xpath = '//*[@id=&quot;ic-resolved-comment-dialog&quot;]/div/div[2]/div[i]/div[2]';const resolved_comments_reply_username_xpath = '//*[@id=&quot;ic-resolved-comment-dialog&quot;]/div/div[2]/div[i]/div[2]/div[j]/div[1]/a[2]';const resolved_comments_reply_text_xpath = '//*[@id=&quot;ic-resolved-comment-dialog&quot;]/div/div[2]/div[i]/div[2]/div[j]/div[2]/div';var resolved_comments_div = document.evaluate(resolved_comments_div_xpath, document).iterateNext();var resolved_comments_count = resolved_comments_div.children.length;var comment_count = i;for (i = 1; i <= resolved_comments_count; i++) {var username = document.evaluate(resolved_comments_username_xpath.replace(/\[i\]/g, &quot;[&quot; + i + &quot;]&quot;), document).iterateNext().textContent;var comment_text = document.evaluate(resolved_comments_text_xpath.replace(/\[i\]/g, &quot;[&quot; + i + &quot;]&quot;), document).iterateNext().innerHTML;var comment = document.evaluate(resolved_comments_comment_xpath.replace(/\[i\]/g, &quot;[&quot; + i + &quot;]&quot;), document).iterateNext().innerHTML;var comment_link = document.evaluate(resolved_comments_link_xpath.replace(/\[i\]/g, &quot;[&quot; + i + &quot;]&quot;), document).iterateNext().lastElementChild.lastElementChild.getElementsByTagName(&quot;a&quot;)[0].href;var reply_count = 0;var reply_count_div = document.evaluate(resolved_comments_reply_div_xpath.replace(/\[i\]/g, &quot;[&quot; + i + &quot;]&quot;), document).iterateNext();if (reply_count_div && reply_count_div.children) {reply_count = reply_count_div.children.length;}var reply_content = &quot;&quot;;if (reply_count > 1) {for (let j = 1; j <= reply_count; j++) {var reply_username = document.evaluate(resolved_comments_reply_username_xpath.replace(/\[i\]/g, &quot;[&quot; + i + &quot;]&quot;).replace(/\[j\]/g, &quot;[&quot; + j + &quot;]&quot;), document).iterateNext().textContent;var reply_comment = document.evaluate(resolved_comments_reply_text_xpath.replace(/\[i\]/g, &quot;[&quot; + i + &quot;]&quot;).replace(/\[j\]/g, &quot;[&quot; + j + &quot;]&quot;), document).iterateNext().innerHTML;if (j < reply_count) {reply_content += '<div style=&quot;margin-bottom:30px;&quot;><p style=&quot;font-style:italic;&quot;>' + reply_username + ':</p>';} else {reply_content += '<div><p style=&quot;font-style:italic;&quot;>' + reply_username + ':</p>';}reply_content += '<div style=&quot;margin-top:4px;&quot;>' + reply_comment + '</div></div>';}} else if (reply_count == 1) {var reply_username = document.evaluate(resolved_comments_reply_username_xpath.replace(/\[i\]/g, &quot;[&quot; + i + &quot;]&quot;).replace(/\[j\]/g, &quot;&quot;), document).iterateNext().textContent;var reply_comment = document.evaluate(resolved_comments_reply_text_xpath.replace(/\[i\]/g, &quot;[&quot; + i + &quot;]&quot;).replace(/\[j\]/g, &quot;&quot;), document).iterateNext().innerHTML;reply_content += '<div><p style=&quot;font-style:italic;&quot;>' + reply_username + ':</p>';reply_content += '<div style=&quot;margin-top:4px; margin-left:10px;&quot;>' + reply_comment + '</div></div>';}var j = 0;if (i == 1) {table_div_content += '<tr style=&quot;background-color:#ecfbf3; border-top-style:double;&quot; ite-row-number=&quot;' + j + '&quot; role=&quot;row&quot;>';} else {table_div_content += '<tr style=&quot;background-color:#ecfbf3;&quot; ite-row-number=&quot;' + j + '&quot; role=&quot;row&quot;>';}table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += (comment_count + 1) + '</td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += '<p><a style=&quot;cursor: pointer;&quot; onclick=&quot;window.open(\'' + comment_link + '\');&quot;>Click here to view this comment</a></p></td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += '<span>' + comment_text + '</span></td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += username + '</td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += comment + '</td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += reply_content + '</td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += 'Resolved' + '</td>';j++;table_div_content += '</tr>';comment_count++;}document.evaluate(resolved_comments_close_btn_xpath, document).iterateNext().click();table_div_content += '</tbody></table>';table_div.innerHTML = table_div_content;var output_div_elem = document.evaluate(output_xpath, document).iterateNext();output_div.appendChild(table_div);output_div_elem.appendChild(output_div);function selectElement(el) {var body = document.body,range, sel;if (document.createRange && window.getSelection) {range = document.createRange();sel = window.getSelection();sel.removeAllRanges();try {range.selectNodeContents(el);sel.addRange(range);} catch (e) {range.selectNode(el);sel.addRange(range);}} else if (body.createTextRange) {range = body.createTextRange();range.moveToElementText(el);range.select();}}selectElement(table_div);document.body.style.cursor = 'default';alert(&quot;Processed all inline comments !\n\nThe comments table has been added at the end of the page and is selected so that you can copy to clipboard !!&quot;);window.location.href = '#comments-section';}, 1000);}function process_open_comments(output_div, table_div, table_div_content) {a[i].click();setTimeout(function() {const username_xpath = '//*[@id=&quot;content&quot;]/div[9]/div/div[1]/div[3]/div[1]/a[2]';const comment_xpath = '//*[@id=&quot;content&quot;]/div[9]/div/div[1]/div[3]/div[2]/div';const reply_container_xpath = '//*[@id=&quot;content&quot;]/div[9]/div/div[2]/div';const reply_username_xpath = '//*[@id=&quot;content&quot;]/div[9]/div/div[2]/div/div[x]/div[1]/a[2]';const reply_comment_xpath = '//*[@id=&quot;content&quot;]/div[9]/div/div[2]/div/div[x]/div[2]/div';var username = document.evaluate(username_xpath, document).iterateNext().textContent;var comment = document.evaluate(comment_xpath, document).iterateNext().innerHTML;var reply_content = &quot;&quot;;var replies = document.evaluate(reply_container_xpath, document).iterateNext().children.length;if (replies > 1) {for (let j = 1; j <= replies; j++) {var reply_username = document.evaluate(reply_username_xpath.replace(&quot;[x]&quot;, &quot;[&quot; + j + &quot;]&quot;), document).iterateNext().textContent;var reply_comment = document.evaluate(reply_comment_xpath.replace(&quot;[x]&quot;, &quot;[&quot; + j + &quot;]&quot;), document).iterateNext().innerHTML;if (j < replies) {reply_content += '<div style=&quot;margin-bottom:30px;&quot;><p style=&quot;font-style:italic;&quot;>' + reply_username + ':</p>';} else {reply_content += '<div><p style=&quot;font-style:italic;&quot;>' + reply_username + ':</p>';}reply_content += '<div style=&quot;margin-top:4px; margin-left:10px;&quot;>' + reply_comment + '</div></div>';}} else if (replies == 1) {var reply_username = document.evaluate(reply_username_xpath.replace(&quot;[x]&quot;, &quot;[&quot; + 1 + &quot;]&quot;), document).iterateNext().textContent;var reply_comment = document.evaluate(reply_comment_xpath.replace(&quot;[x]&quot;, &quot;[&quot; + 1 + &quot;]&quot;), document).iterateNext().innerHTML;reply_content += '<div><p style=&quot;font-style:italic;&quot;>' + reply_username + ':</p>';reply_content += '<div style=&quot;margin-top:4px; margin-left:10px;&quot;>' + reply_comment + '</div></div>';}var exit = false;var elem = a[i];var text = &quot;&quot;;do {if (elem.previousElementSibling) {text += elem.previousElementSibling.tagName + &quot; > &quot;;if (elem.previousElementSibling.tagName.toUpperCase().startsWith(&quot;H&quot;)) {elem = elem.previousElementSibling;exit = true;} else {elem = elem.previousElementSibling;}} else {elem = elem.parentElement;}} while (!exit);var j = 0;table_div_content += '<tr ite-row-number=&quot;' + j + '&quot; role=&quot;row&quot;>';table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += (i + 1) + '</td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += '<a href=&quot;#' + elem.id + '&quot;>' + elem.innerHTML + '</a></td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += '<span>' + a[i].innerHTML + '</span></td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += username + '</td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += comment + '</td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += reply_content + '</td>';j++;table_div_content += '<td style=&quot;text-align: left;&quot; colspan=&quot;1&quot; class=&quot;confluenceTd custom-row&quot; ite-col-number=&quot;' + j + '&quot; data-row-index=&quot;' + i + '&quot;>';table_div_content += 'Open' + '</td>';j++;table_div_content += '</tr>';i++;if (i < a.length) {setTimeout(process_open_comments, 500, output_div, table_div, table_div_content);} else {try {process_resolved_comments(output_div, table_div, table_div_content);} catch (e) {document.body.style.cursor = 'default';console.error(e);document.evaluate(resolved_comments_close_btn_xpath, document).iterateNext().click();alert(&quot;Processing failed !!!\n\n Please check browser's console for details...&quot;);}}}, 500);}try {document.body.style.cursor = 'progress';process_open_comments(output_div, table_div, table_div_content);} catch (e) {document.body.style.cursor = 'default';console.error(e);alert(&quot;Processing failed !!!\n\n Please check browser's console for details...&quot;);}})()">Confluence Comments - Table</a>